create schema do_an;
use do_an;

CREATE TABLE `tutor` (
  `TUTOR_ID` varchar(10) NOT NULL,
  `NAME` varchar(30) DEFAULT NULL,
  `PHONE_NUM` varchar(10) DEFAULT NULL,
  `EMAIL` varchar(30) DEFAULT NULL,
  `ADDRESS` varchar(50) DEFAULT NULL,
  `DOB` date DEFAULT NULL,
  PRIMARY KEY (`TUTOR_ID`)
);


CREATE TABLE `classroom` (
  `classroom_ID` varchar(10) NOT NULL,
  `room no` int DEFAULT NULL,
  PRIMARY KEY (`classroom_ID`)
);

CREATE TABLE `class` (
  `CLASS_ID` varchar(10) NOT NULL,
  `NAME` varchar(30) NOT NULL,
  `TUTOR_ID` varchar(10) DEFAULT NULL,
  `classroom_ID` varchar(10) NOT NULL,
  `SHIFT` varchar(45) DEFAULT NULL,
  `START_DATE` date DEFAULT NULL,
  `END_DATE` date DEFAULT NULL,
  `DAY` varchar(45) DEFAULT NULL,
  PRIMARY KEY (`CLASS_ID`),
  KEY `TUTOR_ID` (`TUTOR_ID`),
  KEY `classroom_ID` (`classroom_ID`),
  CONSTRAINT `class_ibfk_1` FOREIGN KEY (`TUTOR_ID`) REFERENCES `tutor` (`TUTOR_ID`),
  CONSTRAINT `class_ibfk_2` FOREIGN KEY (`classroom_ID`) REFERENCES `classroom` (`classroom_ID`)
);

CREATE TABLE `student` (
  `STU_ID` varchar(10) NOT NULL,
  `NAME` varchar(30) DEFAULT NULL,
  `PHONE_NUM` varchar(10) DEFAULT NULL,
  `EMAIL` varchar(30) DEFAULT NULL,
  `ADDRESS` varchar(50) DEFAULT NULL,
  `DOB` date DEFAULT NULL,
  PRIMARY KEY (`STU_ID`)
);

CREATE TABLE `lesson_report` (
  `CLASS_ID` varchar(10) NOT NULL,
  `LESSON_NO` int NOT NULL,
  `STUDY_CONTENT` varchar(30) DEFAULT NULL,
  `LESSON_DATE` date DEFAULT NULL,
  PRIMARY KEY (`LESSON_NO`,`CLASS_ID`),
  KEY `CLASS_ID` (`CLASS_ID`),
  CONSTRAINT `lesson_report_ibfk_1` FOREIGN KEY (`CLASS_ID`) REFERENCES `class` (`CLASS_ID`)
);

CREATE TABLE `login` (
  `USERNAME` varchar(30) NOT NULL,
  `PASS` varchar(30) DEFAULT NULL,
  `TUTOR_ID` varchar(10) DEFAULT NULL,
  PRIMARY KEY (`USERNAME`),
  KEY `TUTOR_ID` (`TUTOR_ID`),
  CONSTRAINT `login_ibfk_1` FOREIGN KEY (`TUTOR_ID`) REFERENCES `tutor` (`TUTOR_ID`)
);

CREATE TABLE `study_report` (
  `STU_ID` varchar(10) NOT NULL,
  `CLASS_ID` varchar(10) NOT NULL,
  `NO` int NOT NULL,
  `PRG_MARK` decimal(4,2) DEFAULT NULL,
  `MID_TERM` decimal(4,2) DEFAULT NULL,
  `FINAL` decimal(4,2) DEFAULT NULL,
  `TOTAL` decimal(4,2) GENERATED ALWAYS AS (if(((`PRG_MARK` is null) or (`MID_TERM` is null) or (`FINAL` is null)),NULL,(((`PRG_MARK` + `MID_TERM`) + `FINAL`) / 3))) STORED,
  PRIMARY KEY (`STU_ID`,`CLASS_ID`),
  KEY `CLASS_ID` (`CLASS_ID`),
  CONSTRAINT `study_report_ibfk_1` FOREIGN KEY (`STU_ID`) REFERENCES `student` (`STU_ID`),
  CONSTRAINT `study_report_ibfk_2` FOREIGN KEY (`CLASS_ID`) REFERENCES `class` (`CLASS_ID`)
);

CREATE TABLE `attendance` (
  `CLASS_ID` varchar(10) NOT NULL,
  `LESSON_NO` int NOT NULL,
  `STU_ID` varchar(10) NOT NULL,
  PRIMARY KEY (`LESSON_NO`,`CLASS_ID`,`STU_ID`),
  KEY `STU_ID` (`STU_ID`),
  KEY `CLASS_ID` (`CLASS_ID`,`LESSON_NO`),
  KEY `CLASS_ID_2` (`CLASS_ID`,`STU_ID`),
  CONSTRAINT `attendance_ibfk_1` FOREIGN KEY (`CLASS_ID`, `LESSON_NO`) REFERENCES `lesson_report` (`CLASS_ID`, `LESSON_NO`),
  CONSTRAINT `attendance_ibfk_2` FOREIGN KEY (`CLASS_ID`, `LESSON_NO`) REFERENCES `lesson_report` (`CLASS_ID`, `LESSON_NO`),
  CONSTRAINT `attendance_ibfk_3` FOREIGN KEY (`CLASS_ID`, `STU_ID`) REFERENCES `study_report` (`CLASS_ID`, `STU_ID`)
);

INSERT INTO `class` VALUES ('LIS-01.1','LISTENING 1','TCH-01','R_01','09:00 - 11:00','2023-03-01','2023-07-12','Monday'),('LIS-01.2','LISTENING 2','TCH-01','R_02','13:00 - 15:00','2023-03-01','2023-07-12','Tuesday'),('SPK-01.1','SPEAKING 1','TCH-01','R_03','07:00 - 09:00','2023-03-01','2023-07-12','Thursday'),('SPK-02.1','SPEAKING 2','TCH-01','R_04','07:00 - 09:00','2023-03-01','2023-07-12','Wednesday');

INSERT INTO `student` VALUES ('STU-01','LONG','0123456789','STU01GMAIL.COM','12 PHAM VAN DONG TP.THU DUC','2000-02-02'),('STU-02','HO','0112233445','STU02@GMAIL.COM','12 PHAM VAN DONG CAN THO','2001-03-04'),('STU-03','KHANG','0934934934','STU03@GMAIL.COM','12 PHAM VAN DONG TP.HCM','2007-03-01'),('STU-04','THIEN','0923923923','STU04@GMAIL.COM','12 PHAM NGU LAO TP.HCM','2003-01-01'),('STU-05','HUNG','0923928923','STU05@GMAIL.COM','24  TRUONG CHINH TP.THU DUC','2003-12-30'),('STU-06','PHUC','0984984984','STU06@GMAIL.COM','213 LE VAN TONG TP.THU DUC','2004-07-30'),('STU-07','KHA','0999333444','ST07U@GMAIL.COM','111 NGO QUYEM TP.THU DUC','2005-07-20'),('STU-08','NGOC','0238238238','STU08@GMAIL.COM','300 LE LOI TP.THU DUC','2004-10-02'),('STU-09','ANH','0235235238','STU09@GMAIL.COM','12 LE THANH TONG TP.THU DUC','2002-11-12'),('STU-10','MY','0934934298','STU10@GMAIL.COM',' 222 HA DO TP.HCM','2002-05-06'),('STU-11','LONG','0123456789','STU11GMAIL.COM','12 PHAM VAN DONG TP.THU DUC','2000-02-02'),('STU-12','HO','0112233445','STU12@GMAIL.COM','12 PHAM VAN DONG CAN THO','2001-03-04'),('STU-13','HA','0934934934','STU13@GMAIL.COM','12 PHAM VAN DONG TP.HCM','2007-03-01'),('STU-14','PHUC','0923923923','STU14@GMAIL.COM','12 PHAM NGU LAO TP.HCM','2003-01-01'),('STU-15','PHAM','0923928923','STU15@GMAIL.COM','24  TRUONG CHINH TP.THU DUC','2003-12-30'),('STU-16','LAM','0984984984','STU16@GMAIL.COM','213 LE VAN TONG TP.THU DUC','2004-07-30'),('STU-17','QUANG','0999333444','ST17U@GMAIL.COM','111 NGO QUYEM TP.THU DUC','2005-07-20'),('STU-18','NGOC','0238238238','STU18@GMAIL.COM','300 LE LOI TP.THU DUC','2004-10-02'),('STU-19','TUAN','0235235238','STU19@GMAIL.COM','12 LE THANH TONG TP.THU DUC','2002-11-12'),('STU-20','MY','0934934298','STU20@GMAIL.COM',' 222 HA DO TP.HCM','2002-05-06');

INSERT INTO `classroom` VALUES ('R_01',101),('R_10',104),('R-02',222),('R-03',103),('R-04',203),('R-05',201),('R-06',111),('R-07',223),('R-08',106),('R-09',102);

INSERT INTO `lesson_report` VALUES ('LIS-01.1',1,'EXAM','2023-04-05'),('LIS-01.2',1,'CHAP 2','2023-04-03'),('SPK-01.1',1,'CHAP 1','2023-02-01'),('LIS-01.1',2,'EVALUATION','2023-04-10'),('LIS-01.2',2,'CD LISTENING','2023-04-10'),('SPK-01.1',2,'CHAP 2','2023-02-03'),('LIS-01.1',3,'LISTENING','2023-04-15'),('LIS-01.2',3,'SONG LISTENING','2023-04-15'),('SPK-01.1',3,'CHAP 3','2023-02-05'),('SPK-02.1',3,'QUIZ','2023-02-15'),('LIS-01.1',4,'BREAK','2023-04-18'),('LIS-01.2',4,'ko biet',NULL),('SPK-01.1',4,'MID TERM','2023-02-10'),('SPK-02.1',4,'BREAK','2023-02-20'),('LIS-01.1',5,'Break',NULL),('SPK-02.1',5,'CHAP 4','2023-03-04'),('LIS-01.1',6,'OKE',NULL),('SPK-02.1',6,'FINAL','2023-04-12'),('LIS-01.1',7,'SPEAKING 01',NULL),('LIS-01.1',8,'CLIMATE CHANGE',NULL),('LIS-01.1',9,'READING TEST',NULL);

INSERT INTO `login` VALUES ('122','123','TCH-02'),('222','123','TCH-03'),('333','123','TCH-04'),('444','123','TCH-05'),('toiday','123','TCH-01');

INSERT INTO `study_report` (`STU_ID`, `CLASS_ID`, `NO`, `PRG_MARK`, `MID_TERM`, `FINAL`) VALUES ('STU-01','LIS-01.2',1,8.00,6.00,9.00),('STU-01','SPK-01.1',1,8.00,8.00,7.00),('STU-02','SPK-01.1',2,7.50,6.00,7.50),('STU-02','SPK-02.1',1,8.25,6.50,7.25),('STU-03','LIS-01.1',1,5.00,5.00,5.00),('STU-03','LIS-01.2',2,7.00,4.00,10.00),('STU-03','SPK-01.1',3,8.00,8.00,7.00),('STU-04','LIS-01.1',2,10.00,10.00,10.00),('STU-04','LIS-01.2',3,7.75,9.25,9.50),('STU-04','SPK-01.1',4,7.50,6.00,7.50),('STU-04','SPK-02.1',2,8.00,8.50,7.00),('STU-05','LIS-01.2',4,9.00,5.50,7.25),('STU-05','SPK-01.1',5,8.00,8.00,7.00),('STU-06','LIS-01.1',3,8.00,8.00,10.00),('STU-06','SPK-01.1',6,7.50,6.00,7.50),('STU-06','SPK-02.1',3,6.50,6.00,7.50),('STU-07','LIS-01.1',4,8.00,8.00,8.00),('STU-07','SPK-01.1',7,8.00,8.00,7.00),('STU-08','LIS-01.1',5,10.00,8.00,8.75),('STU-08','LIS-01.2',5,10.00,8.00,8.75),('STU-08','SPK-01.1',8,7.50,6.00,7.50),('STU-08','SPK-02.1',4,8.25,8.00,7.00),('STU-09','LIS-01.1',6,10.00,8.00,10.00),('STU-09','LIS-01.2',6,10.00,8.00,10.00),('STU-09','SPK-01.1',9,8.00,8.00,7.00),('STU-10','LIS-01.1',7,8.50,8.75,7.50),('STU-10','LIS-01.2',7,8.50,8.75,7.50),('STU-10','SPK-01.1',10,7.50,6.00,7.50),('STU-11','LIS-01.1',8,8.50,8.75,7.50),('STU-11','SPK-02.1',5,5.00,6.00,8.50),('STU-13','SPK-02.1',6,6.00,8.00,7.00),('STU-14','LIS-01.1',9,10.00,8.00,8.75),('STU-14','SPK-02.1',7,6.75,6.00,9.50),('STU-15','SPK-02.1',8,8.00,8.00,7.00),('STU-16','LIS-01.1',10,6.00,8.00,10.00),('STU-16','LIS-01.2',8,8.50,8.75,7.50),('STU-17','LIS-01.2',9,10.00,8.00,8.75),('STU-17','SPK-02.1',9,7.50,6.00,10.00),('STU-19','LIS-01.2',10,10.00,8.00,10.00),('STU-19','SPK-02.1',10,8.00,8.00,8.00),('STU-20','SPK-02.1',11,9.00,6.00,7.50);

INSERT INTO `tutor` VALUES ('TCH-01','NGUYEN VAN B','933355588','BABY@GMAIL.COM','44 DIEN BIEN PHU P10 Q10','1980-01-02'),('TCH-02','NGUYEN VAN C','933344499','PDAWG@GMAIL.COM','222 Y CHINH THANG Q3','1970-11-01'),('TCH-03','NGUYEN THI A','233344455','VALVE@GMAIL.COM','300 NGUYEN DINH CHIEU P1 Q3','1990-01-22'),('TCH-04','NGUYEN VO A','388844455','GAWR@GMAIL.COM','412 CAO THANG P12 Q10','1988-11-30'),('TCH-05','VO VAN A','344244455','MORR@GMAIL.COM',' 12 LE HONG PHONG P2 Q7','2000-03-02');

INSERT INTO `attendance` VALUES ('LIS-01.1',2,'STU-03'),('LIS-01.1',5,'STU-03'),('LIS-01.1',9,'STU-03'),('LIS-01.1',7,'STU-04'),('LIS-01.2',4,'STU-05'),('LIS-01.1',1,'STU-06'),('LIS-01.1',7,'STU-06'),('LIS-01.1',5,'STU-09'),('LIS-01.1',5,'STU-10'),('LIS-01.1',5,'STU-11'),('LIS-01.1',5,'STU-14'),('LIS-01.1',5,'STU-16');















